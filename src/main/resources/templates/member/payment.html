<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>구독 서비스</title>
    <link data-vue-meta="1" rel="shortcut icon" href="/images/member/icon.png">
    <link rel="stylesheet" href="/css/member/payment.css">
    
    <link rel="stylesheet" href="/font/didactgothic.woff2">
    <link rel="stylesheet" href="/font/materialdesignicons-webfont-d5cba82059f88bfa469e.woff2">
    <link rel="stylesheet" href="/font/roboto-cyrillic-700-normal-d010f1f324e111a22e53.woff2">
    <link rel="stylesheet" href="/font/roboto-cyrillic-ext-700-normal-be4d02458ce53887dc37.woff2">
    <link rel="stylesheet" href="/font/roboto-greek-700-normal-50e795c1345353b0e996.woff2">
    <link rel="stylesheet" href="/font/roboto-greek-ext-700-normal-bd9854c751441ccc1a70.woff2">
    <link rel="stylesheet" href="/font/roboto-latin-700-normal-227c93190fe7f82de3f8.woff2">
    <link rel="stylesheet" href="/font/roboto-latin-ext-700-normal-ed67ad54b1a8f5d21150.woff2">
    <link rel="stylesheet" href="/font/roboto-vietnamese-700-normal-3425a701027d0699e369.woff2">

</head>
<body>
    <main class="main">
        <div class="main-1">
            <h1 class="main-2">구독 서비스<br>결제 비용을 알려드려요</h1>
            <div class="main-3">
                <div>
                    <article>
                        <div class="main-4">
                            <section>
                                <h2 class="main-5">구독 가격</h2>
                                <div class="main-6">
                                    <div>
                                        <div class="main-7">
                                            <span class="main-15">평균</span>
                                            <strong class="main-8">월</strong>
                                            <strong class="main-8">
                                                <span class="main-9">
                                                    <span data-visible="true" class="main-10"> 2</span>
                                                        <span>만</span>
                                                    </span>
                                                </span>
                                            원
                                            </strong>
                                        </div>
                                    </div>
                                    <img alt="서비스 예상 견적" width="40" height="40" decoding="async" data-nimg="1" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQgOS43NzVDNCA2Ljc5MjY2IDYuNDE3NjYgNC4zNzUgOS40IDQuMzc1SDMwLjZDMzMuNTgyMyA0LjM3NSAzNiA2Ljc5MjY2IDM2IDkuNzc1VjMwLjk3NUMzNiAzMy45NTczIDMzLjU4MjMgMzYuMzc1IDMwLjYgMzYuMzc1SDkuNEM2LjQxNzY2IDM2LjM3NSA0IDMzLjk1NzMgNCAzMC45NzVWOS43NzVaIiBmaWxsPSIjMUYwMDRGIi8+CjxwYXRoIGQ9Ik0yMCAyNS44MzJDMjAgMjIuNzk0NSAyMi40NjI0IDIwLjMzMiAyNS41IDIwLjMzMkgzNlYzMC44MzJDMzYgMzMuODY5NiAzMy41Mzc2IDM2LjMzMiAzMC41IDM2LjMzMkgyMFYyNS44MzJaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXJfMzQ2N184NzUyMCkiLz4KPHBhdGggZD0iTTEyLjQ5OSA5LjVDMTMuMDUxMyA5LjUgMTMuNDk5IDkuOTQ3NzIgMTMuNDk5IDEwLjVWMTIuNUgxNS41QzE2LjA1MjMgMTIuNSAxNi41IDEyLjk0NzcgMTYuNSAxMy41QzE2LjUgMTQuMDUyMyAxNi4wNTIzIDE0LjUgMTUuNSAxNC41SDEzLjQ5OVYxNi41QzEzLjQ5OSAxNy4wNTIzIDEzLjA1MTMgMTcuNSAxMi40OTkgMTcuNUMxMS45NDcgMTcuNDk5NyAxMS40OTkgMTcuMDUyMSAxMS40OTkgMTYuNVYxNC41SDkuNUM4Ljk0NzczIDE0LjUgOC41MDAwMiAxNC4wNTIzIDguNSAxMy41QzguNSAxMi45NDc3IDguOTQ3NzIgMTIuNSA5LjUgMTIuNUgxMS40OTlWMTAuNUMxMS40OTkgOS45NDc4OCAxMS45NDcgOS41MDAyNiAxMi40OTkgOS41WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTE0LjAzNTEgMjQuNTUwN0MxNC40MjU2IDI0LjE2MDIgMTUuMDU5NiAyNC4xNjAyIDE1LjQ1MDEgMjQuNTUwN0MxNS44NDAzIDI0Ljk0MTIgMTUuODQwMyAyNS41NzQzIDE1LjQ1MDEgMjUuOTY0OEwxNC4wMzkgMjcuMzc0OUwxNS40NTc5IDI4Ljc5MjlDMTUuODQ4NSAyOS4xODM0IDE1Ljg0ODUgMjkuODE3NCAxNS40NTc5IDMwLjIwNzlDMTUuMDY3NCAzMC41OTg0IDE0LjQzMzQgMzAuNTk4NCAxNC4wNDI5IDMwLjIwNzlMMTIuNjI0OSAyOC43ODlMMTEuMjA3IDMwLjIwNzlDMTAuODE2NSAzMC41OTgxIDEwLjE4MzQgMzAuNTk4MSA5Ljc5Mjg5IDMwLjIwNzlDOS40MDIzNyAyOS44MTc0IDkuNDAyMzcgMjkuMTgzNCA5Ljc5Mjg5IDI4Ljc5MjlMMTEuMjA5OSAyNy4zNzQ5TDkuODAwNzEgMjUuOTY0OEM5LjQxMDI0IDI1LjU3NDMgOS40MTAyNCAyNC45NDEyIDkuODAwNzEgMjQuNTUwN0MxMC4xOTEyIDI0LjE2MDIgMTAuODI0MiAyNC4xNjAyIDExLjIxNDggMjQuNTUwN0wxMi42MjQ5IDI1Ljk1OTlMMTQuMDM1MSAyNC41NTA3WiIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMjMuNSIgeT0iMTIiIHdpZHRoPSI4IiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMzEgMjlDMzEuNTUyMyAyOSAzMiAyOS40NDc3IDMyIDMwQzMyIDMwLjU1MjMgMzEuNTUyMyAzMSAzMSAzMUgyNUMyNC40NDc3IDMxIDI0IDMwLjU1MjMgMjQgMzBDMjQgMjkuNDQ3NyAyNC40NDc3IDI5IDI1IDI5SDMxWk0zMSAyNUMzMS41NTIzIDI1IDMyIDI1LjQ0NzcgMzIgMjZDMzIgMjYuNTUyMyAzMS41NTIzIDI3IDMxIDI3SDI1QzI0LjQ0NzcgMjcgMjQgMjYuNTUyMyAyNCAyNkMyNCAyNS40NDc3IDI0LjQ0NzcgMjUgMjUgMjVIMzFaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyXzM0NjdfODc1MjAiIHgxPSIyOCIgeTE9IjIwLjMzMiIgeDI9IjI4IiB5Mj0iMzYuMzMyIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiM4NjVGRkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNjMwMkZCIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==" style="color: transparent;">
                                </div>
                            </section>
                        </div>
                        <section>
                            <h2 class="main-11">구독 혜택은 어떻게 되나요?</h2>
                            <p class="main-12">서비스 이용에 있어 제한을 해제하고 매월 상담비 5%할인 쿠폰 3개를 받아보세요.</p>
                            <p class="main-12">상담사님을 팔로우하고 팔로우한 상담사님의 오늘의 좋은말을 메일로 받아보세요!</p>
                        </section>
                    </article>
                </div>
                <aside class="main-13">
                    <h2>구독서비스를 신청하고<br>혜택을 받아보세요!</h2>
                    <button type="button" class="main-14" onclick="pay()">구독하기</button>
                </aside>
            </div>
        </div>
    </main>
    <form id="paymentForm" action="/member/mypage" method="post">
        <input type="hidden" name="id" id="id">
        <input type="hidden" name="subscribeId" id="subscribeId">
        <input type="hidden" name="memberId" id="memberId">
    </form>
</body>
<script src="/js/member/payment.js"></script>
<script src="https://js.bootpay.co.kr/bootpay-5.1.5.min.js"></script>
<script>
    const pay = async () => {
        try {
            const response = await Bootpay.requestPayment({
                application_id: "687efaa4285ac508a5ee7ab9",
                price: 20000,
                order_name: "테스트결제",
                order_id: "TEST_ORDER_ID",
                pg: "카카오페이",
                // method: "계좌이체",
                tax_free: 0,
                user: {
                    id: "회원아이디",
                    username: "회원이름",
                    phone: "01000000000",
                    email: "test@test.com",
                },
                items: [
                    {
                        id: "item_id",
                        name: "테스트아이템",
                        qty: 1,
                        price: 20000,
                    },
                ],
                extra: {
                    open_type: "iframe",
                    card_quota: "0,2,3",
                    escrow: false,
                },
            });
            switch (response.event) {
                case "issued":
                    // 가상계좌 입금 완료 처리
                    break;
                case "done":
                    console.log(response);
                    if(response.event === "done") {
                        document.getElementById("paymentForm").submit();
                    }
                    // 결제 완료 처리
                    break;
                case "confirm": //payload.extra.separately_confirmed = true; 일 경우 승인 전 해당 이벤트가 호출됨
                    console.log(response.receipt_id);
                    /**
                     * 1. 클라이언트 승인을 하고자 할때
                     * // validationQuantityFromServer(); //예시) 재고확인과 같은 내부 로직을 처리하기 한다.
                     */
                    const confirmedData = await Bootpay.confirm(); //결제를 승인한다
                    if (confirmedData.event === "done") {
                        //결제 성공
                    }

                    /**
                     * 2. 서버 승인을 하고자 할때
                     * // requestServerConfirm(); //예시) 서버 승인을 할 수 있도록  API를 호출한다. 서버에서는 재고확인과 로직 검증 후 서버승인을 요청한다.
                     * Bootpay.destroy(); //결제창을 닫는다.
                     */
                    break;
            }
        } catch (e) {
            // 결제 진행중 오류 발생
            // e.error_code - 부트페이 오류 코드
            // e.pg_error_code - PG 오류 코드
            // e.message - 오류 내용
            console.log(e.message);
            switch (e.event) {
                case "cancel":
                    // 사용자가 결제창을 닫을때 호출
                    console.log(e.message);
                    break;
                case "error":
                    // 결제 승인 중 오류 발생시 호출
                    console.log(e.error_code);
                    break;
            }
        }
    };
</script>
</html>